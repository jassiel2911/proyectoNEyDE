{% extends 'base.html' %}

{% block content %}
<div id="app">
    <h1>Selecciona un Negocio</h1>

    <div class="container mt-4">
        <h2>Negocios Disponibles</h2>
        <div class="row">
            <div class="col-md-4 mb-4" v-for="negocio in negocios" :key="negocio.id">
                <div class="card">
                    <div class="card-body">
                        <h5 class="card-title" v-text="negocio.nombre"></h5>
                        <p class="card-text" v-text="negocio.descripcion"></p>
                        <button @click="verProductos(negocio.id)" class="btn btn-primary">Ver Productos</button>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
{% endblock %}

{% block scripts %}
<script src="https://cdn.jsdelivr.net/npm/vue@2.6.14/dist/vue.js"></script>
<script>
    const app = new Vue({
        el: '#app',
        data: {
            negocios: []
        },
        mounted() {
            this.fetchNegocios();
        },
        methods: {
            fetchNegocios() {
                fetch('/api/negocios/')
                    .then(response => response.json())
                    .then(data => {
                        this.negocios = data;
                    })
                    .catch(error => console.error('Error:', error));
            },
            verProductos(negocioId) {
                window.location.href = `/negocios/${negocioId}/productos/`;
            }
        }
    });
</script>
{% endblock %}